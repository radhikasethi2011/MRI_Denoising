24-06-05 17:39:23.423 - INFO:   name: hardi150_v3
  phase: train
  gpu_ids: [0]
  path:[
    log: C:/Users/ebjor/DDM2/logs_v3
    tb_logger: C:/Users/ebjor/DDM2/tb_logger_v3
    results: C:/Users/ebjor/DDM2/results_v3
    checkpoint: C:/Users/ebjor/DDM2/checkpoint_v3
    resume_state: None
    experiments_root: experiments\hardi150_v3_240605_173923
  ]
  datasets:[
    train:[
      name: hardi
      dataroot: C:/Users/ebjor/.dipy/stanford_hardi/HARDI150.nii.gz
      valid_mask: [10, 160]
      phase: train
      padding: 3
      val_volume_idx: 40
      val_slice_idx: 40
      batch_size: 16
      in_channel: 1
      num_workers: 0
      use_shuffle: True
    ]
    val:[
      name: hardi
      dataroot: C:/Users/ebjor/.dipy/stanford_hardi/HARDI150.nii.gz
      valid_mask: [10, 160]
      phase: val
      padding: 3
      val_volume_idx: 40
      val_slice_idx: 40
      batch_size: 1
      in_channel: 1
      num_workers: 0
      data_len: 3
    ]
  ]
  model:[
    which_model_G: mri
    finetune_norm: False
    drop_rate: 0.0
    unet:[
      in_channel: 1
      out_channel: 1
      inner_channel: 32
      norm_groups: 32
      channel_multiplier: [1, 2, 4, 8]
      attn_res: [16]
      res_blocks: 1
      dropout: 0.0
      version: v2
    ]
    beta_schedule:[
      train:[
        schedule: rev_warmup80
        n_timestep: 1500
        linear_start: 5e-05
        linear_end: 0.01
      ]
      val:[
        schedule: rev_warmup80
        n_timestep: 1500
        linear_start: 5e-05
        linear_end: 0.01
      ]
    ]
    diffusion:[
      image_size: 128
      channels: 3
      conditional: True
    ]
  ]
  train:[
    n_iter: 2000
    val_freq: 100
    save_checkpoint_freq: 500
    print_freq: 50
    optimizer:[
      type: adam
      lr: 0.0002
    ]
    ema_scheduler:[
      step_start_ema: 500
      update_ema_every: 1
      ema_decay: 0.995
    ]
  ]
  noise_model:[
    resume_state: C:/Users/ebjor/DDM2/checkpoint_v3/latest
    drop_rate: 0.0
    unet:[
      in_channel: 2
      out_channel: 1
      inner_channel: 32
      norm_groups: 32
      channel_multiplier: [1, 2, 4, 8]
      attn_res: [16]
      res_blocks: 1
      dropout: 0.0
      version: v2
    ]
    beta_schedule:[
      linear_start: 5e-05
      linear_end: 0.01
    ]
    n_iter: 2000
    val_freq: 100
    save_checkpoint_freq: 500
    print_freq: 10
    optimizer:[
      type: adam
      lr: 0.0002
    ]
  ]
  stage2_file: C:/Users/ebjor/DDM2/checkpoint_v3/initial_stage.txt
  distributed: False

24-06-05 17:39:26.020 - INFO: MRI dataset [hardi] is created.
24-06-05 17:39:27.784 - INFO: MRI dataset [hardi] is created.
24-06-05 17:39:27.784 - INFO: Initial Dataset Finished
24-06-05 17:39:30.873 - INFO: Initialization method [orthogonal]
24-06-05 17:39:31.679 - INFO: Loading stage1 pretrained model for G [C:/Users/ebjor/DDM2/checkpoint_v3/latest_gen.pth] ...
24-06-05 17:39:31.728 - INFO: [DDM2] is created.
24-06-05 17:39:31.728 - INFO: Initial Model Finished
24-06-05 17:39:46.266 - INFO: <epoch:  1, iter:      50> l_pix: 1.1284e-01 
24-06-05 17:39:57.353 - INFO: <epoch:  1, iter:     100> l_pix: 2.8255e-02 
24-06-05 17:40:16.990 - INFO: <epoch:  1, iter:     150> l_pix: 1.7721e-02 
24-06-05 17:40:28.407 - INFO: <epoch:  1, iter:     200> l_pix: 1.6520e-02 
24-06-05 17:40:47.014 - INFO: <epoch:  1, iter:     250> l_pix: 2.5018e-02 
24-06-05 17:40:58.558 - INFO: <epoch:  1, iter:     300> l_pix: 1.9446e-02 
24-06-05 17:41:17.866 - INFO: <epoch:  1, iter:     350> l_pix: 2.3755e-02 
24-06-05 17:41:29.688 - INFO: <epoch:  1, iter:     400> l_pix: 8.4731e-03 
24-06-05 17:41:48.661 - INFO: <epoch:  1, iter:     450> l_pix: 1.4266e-02 
24-06-05 17:42:00.703 - INFO: <epoch:  1, iter:     500> l_pix: 1.6930e-02 
24-06-05 17:42:09.086 - INFO: Saving models and training states.
24-06-05 17:42:09.425 - INFO: Saved model in [C:/Users/ebjor/DDM2/checkpoint_v3\latest_gen.pth] ...
24-06-05 17:42:21.406 - INFO: <epoch:  1, iter:     550> l_pix: 7.6678e-03 
24-06-05 17:42:33.624 - INFO: <epoch:  1, iter:     600> l_pix: 9.6067e-03 
24-06-05 17:42:52.717 - INFO: <epoch:  1, iter:     650> l_pix: 1.0531e-02 
24-06-05 17:43:05.406 - INFO: <epoch:  1, iter:     700> l_pix: 1.6020e-02 
24-06-05 17:43:27.274 - INFO: <epoch:  2, iter:     750> l_pix: 8.1836e-03 
24-06-05 17:43:39.628 - INFO: <epoch:  2, iter:     800> l_pix: 1.0066e-02 
24-06-05 17:43:59.483 - INFO: <epoch:  2, iter:     850> l_pix: 9.6721e-03 
24-06-05 17:44:12.212 - INFO: <epoch:  2, iter:     900> l_pix: 9.5815e-03 
24-06-05 17:44:32.705 - INFO: <epoch:  2, iter:     950> l_pix: 8.5069e-03 
24-06-05 17:44:45.324 - INFO: <epoch:  2, iter:   1,000> l_pix: 1.5113e-02 
24-06-05 17:44:52.886 - INFO: Saving models and training states.
24-06-05 17:44:53.205 - INFO: Saved model in [C:/Users/ebjor/DDM2/checkpoint_v3\latest_gen.pth] ...
24-06-05 17:45:05.682 - INFO: <epoch:  2, iter:   1,050> l_pix: 6.9476e-03 
24-06-05 17:45:18.332 - INFO: <epoch:  2, iter:   1,100> l_pix: 1.0928e-02 
24-06-05 17:45:38.484 - INFO: <epoch:  2, iter:   1,150> l_pix: 7.5458e-03 
24-06-05 17:45:51.463 - INFO: <epoch:  2, iter:   1,200> l_pix: 5.4668e-03 
24-06-05 17:46:11.124 - INFO: <epoch:  2, iter:   1,250> l_pix: 1.0978e-02 
24-06-05 17:46:23.832 - INFO: <epoch:  2, iter:   1,300> l_pix: 1.7981e-02 
24-06-05 17:46:43.802 - INFO: <epoch:  2, iter:   1,350> l_pix: 4.8884e-03 
24-06-05 17:46:56.333 - INFO: <epoch:  2, iter:   1,400> l_pix: 1.4863e-02 
24-06-05 17:47:16.303 - INFO: <epoch:  3, iter:   1,450> l_pix: 1.8528e-02 
24-06-05 17:47:29.223 - INFO: <epoch:  3, iter:   1,500> l_pix: 2.0834e-02 
24-06-05 17:47:36.563 - INFO: Saving models and training states.
24-06-05 17:47:36.868 - INFO: Saved model in [C:/Users/ebjor/DDM2/checkpoint_v3\latest_gen.pth] ...
24-06-05 17:47:49.285 - INFO: <epoch:  3, iter:   1,550> l_pix: 5.8617e-03 
24-06-05 17:48:01.862 - INFO: <epoch:  3, iter:   1,600> l_pix: 7.3824e-03 
24-06-05 17:48:21.510 - INFO: <epoch:  3, iter:   1,650> l_pix: 7.7250e-03 
24-06-05 17:48:33.980 - INFO: <epoch:  3, iter:   1,700> l_pix: 4.1909e-03 
24-06-05 17:48:53.786 - INFO: <epoch:  3, iter:   1,750> l_pix: 5.1933e-03 
24-06-05 17:49:06.533 - INFO: <epoch:  3, iter:   1,800> l_pix: 1.0736e-02 
24-06-05 17:49:26.535 - INFO: <epoch:  3, iter:   1,850> l_pix: 5.2926e-03 
24-06-05 17:49:39.676 - INFO: <epoch:  3, iter:   1,900> l_pix: 8.6285e-03 
24-06-05 17:50:00.146 - INFO: <epoch:  3, iter:   1,950> l_pix: 1.1972e-02 
24-06-05 17:50:13.078 - INFO: <epoch:  3, iter:   2,000> l_pix: 8.8670e-03 
24-06-05 17:50:20.435 - INFO: Saving models and training states.
24-06-05 17:50:20.717 - INFO: Saved model in [C:/Users/ebjor/DDM2/checkpoint_v3\latest_gen.pth] ...
24-06-05 17:50:20.733 - INFO: End of training.
